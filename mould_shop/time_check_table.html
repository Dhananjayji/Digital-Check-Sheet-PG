<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Multi-Sheet Table</title>
   <style>
      body {
         font-family: Arial, sans-serif;
      }

      /* .controls1 {
         display: inline-block;
         position: fixed;
         top: 42px;
         left: 0;
         z-index: 999;
         background-color: #f4f4f4;
         padding: 10px;
         box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      } */

      .controls2 {
         display: inline-block;
         position: fixed;
         top: 42px;
         right: 0;
         z-index: 999;
         background-color: #f4f4f4;
         padding: 10px;
         box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);

      }

      .sheet-buttons {
         display: flex;
         overflow-x: auto;
         white-space: nowrap;
         position: fixed;
         top: 0px;
         margin-bottom: 20px;
         background-color: #f4f4f4;
         padding: 10px;
         text-align: center;
         z-index: 999;
         box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      .sheet-buttons button {
         flex-shrink: 0;
         margin-right: 10px;
      }

      /* .controls {
         display: inline-block;
         position: fixed;
         top: 42px;
         left: 0px;

      } */

      /* .sheet-buttons button {
         margin-right: 10px;
         padding: 10px 20px;
         cursor: pointer;
         background-color: #f0f0f0;
         border: 1px solid #ccc;
      } */

      .sheet-buttons button.active {
         background-color: #007bff;
         color: white;
         border: 1px solid #0056b3;
      }

      .options-menu {
        display: none;
        position: absolute;
        background-color: #fff;
        border: 1px solid #ccc;
        padding: 4px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        /* text-align:left; */
        width: 111px;
        border-radius: 15px;
        /* cursor: pointer; */
      }

      .options-menu button {
         width: 100%;
         padding: 4px;
         margin: 4px 0;
         text-align: center;
         background-color: #f4f4f4;
         border: 1px solid #ccc;
         cursor: pointer;
        
         border-radius: 15px;
         
      }


      table {
         width: 100%;
         border-collapse: collapse;
         font-size: 12px;

         margin-top: 86px;
      }

      th,
      td {
         border: 1px solid #ccc;
         text-align: center;
         background-color: #f4f4f4;
         /* padding: 10px; */
         padding-left: 2px;
         text-align: center;

      }

      th {
         font-weight: bold;
      }

      td.selected {
         background-color: rgb(118, 182, 118);
      }

      /* .controls {
            margin-top: 20px;
        } */

      /* .controls button {
            margin-right: 10px;
            padding: 10px 15px;
            cursor: pointer;
        } */
      .c {
         text-align: left;
      }

      .image {
         display: block;
         align-items: center;
      }

      th:first-child(1),
      td:first-child(1) {
         width: 6%;
      }

      th:nth-child(2),
      td:nth-child(2) {
         width: 12%;
      }

      th:nth-child(3),
      td:nth-child(3) {
         width: 6%;
      }

      th:nth-child(4),
      td:nth-child(4) {
         width: 6%;
      }

      th:nth-child(5),
      td:nth-child(5) {
         width: 6%;
      }

      th:nth-child(6),
      td:nth-child(6) {
         width: 6%;
      }

      th:nth-child(7),
      td:nth-child(7) {
         width: 6%;
      }

      th:nth-child(8),
      td:nth-child(8) {
         width: 6%;
      }

      th:nth-child(9),
      td:nth-child(9) {
         width: 6%;
      }

      th:nth-child(10),
      td:nth-child(10) {
         width: 6%;
      }

      th:nth-child(11),
      td:nth-child(11) {
         width: 6%;
      }

      th:nth-child(12),
      td:nth-child(12) {
         width: 6%;
      }

      th:nth-child(13),
      td:nth-child(13) {
         width: 6%;
      }

      th:nth-child(14),
      td:nth-child(14) {
         width: 6%;
      }

      th:nth-child(15),
      td:nth-child(15) {
         width: 6%;
      }

      th:nth-child(16),
      td:nth-child(16) {
         width: 6%;
      }


      @media print {
         body * {
            visibility: hidden;
         }

         table,
         table * {
            visibility: visible;
         }
      }


      .special-menu {
         display: none;
         position: absolute;
         background-color: #fff;
         border: 1px solid #ccc;
         padding: 5px;
         box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
         z-index: 1000;
      }

      input[type="text"] {
         width: 100%;
         height: 100%;
         box-sizing: border-box;
         padding: 0;
         margin: 0;
         border: none;
         font-size: 12px;
      }



   </style>
</head>

<body>
   <div class="sheet-buttons">
      <!-- Generate sheet buttons -->
      <script>
         for (let i = 1; i <= 15; i++) {
            document.write(`<button id="sheet${i}" onclick="switchSheet(${i})">Sheet ${i}</button>`);
         }
      </script>
   </div>


   <div id="optionsMenu" class="options-menu">
    <button onclick="setSelectedOption('OK')">Set OK</button>
    <button onclick="setSelectedOption('NG')">Set NG</button>
    <button onclick="enterText()">Enter Text</button>
    <button onclick="setSelectedOption('')">Clear Cell</button>
    <button onclick="toggleSpecialMenu()">Special Symbol</button>
 </div>

 <div id="specialMenu" class="special-menu">
    <button onclick="specialText('-')">-</button>
    <button onclick="specialText('⌀')">⌀</button>
    <button onclick="specialText('±')">±</button>
 </div>

   <!-- <div class="controls1">
      <button onclick="setSelectedOption('OK')" style="background-color:rgb(118, 182, 118) ;">Set OK</button>
      <button onclick="setSelectedOption('NG')" style="background-color:rgb(118, 182, 118) ;">Set NG</button>
      <button onclick="setSelectedOption('')" style="background-color:rgb(118, 182, 118) ;">Clear Cell</button>
      <button onclick="enterText()" style="background-color:rgb(118, 182, 118) ;">Enter Text</button>
   </div> -->



   <div class="controls2">
      <!-- <button onclick="saveTableData()" style="background-color:rgb(118, 182, 118) ;">Save</button> -->

      <button onclick="clearTableData()" style="background-color:rgb(118, 182, 118) ;">Reset Sheet</button>
      <button onclick="backToIndex()" style="background-color:rgb(118, 182, 118) ;">Back</button>

      <button onclick="printTable()" style="background-color:rgb(118, 182, 118) ;">Print</button>
   </div>


   <div id="optionsMenu" class="options-menu">
    <button onclick="setSelectedOption('OK')">Set OK</button>
    <button onclick="setSelectedOption('NG')">Set NG</button>
    <button onclick="enterText()">Enter Text</button>
    <button onclick="setSelectedOption('')">Clear Cell</button>
    <button onclick="toggleSpecialMenu()">Special Symbol</button>
 </div>

 <div id="specialMenu" class="special-menu">
    <button onclick="specialText('-')">-</button>
    <button onclick="specialText('⌀')">⌀</button>
    <button onclick="specialText('±')">±</button>
 </div>

 <table id="dataTable">
   <thead>
      <tr>
         <th colspan="2" style="align-items: center;"><img class="image" src="../images/pg_logo.png" alt="Logo"
               style="height: 50px; width: 100px;"></th>
         <th colspan="12" style="font-size:20px">TIME CHECK REPORT(MOULDING)</th>
         <th colspan="2" style="font-size:8px">Ref No:PGTL/QA/TCR/22<br> Issue No/Date:31.08.2024 <br> Rev No.:00,Rev
            date: 00</th>
      </tr>
   </thead>
   <tbody>
      <tr>
         <th colspan="1" class="c">Date</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <th colspan="2">SHIFT</th>
         <th colspan="3">A</th>
         <th colspan="3">B</th>
         <th colspan="2">SHIFT</th>
         <th colspan="2">A</th>
         <th colspan="2">B</th>
      </tr>
      <tr>
         <th colspan="1" class="c" rowspan="2">M/C NAME / NO.</th>
         <td colspan="1" rowspan="2" onclick="selectCell(this, event)"></td>
         <th colspan="2" class="c">RAW MATERIAL & GRADE</th>
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <th colspan="2" class="c">MASTER BATCH & %</th>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>

         <th colspan="2" class="c">PART NAME</th>
         <!-- <td colspan="1" onclick="selectCell(this, event)"></td> -->
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <th colspan="1" class="c">DATE:</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <!-- <th></th> -->
         <td colspan="2" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="1" rowspan="3" class="c">Mould Change If Any</th>
         <td colspan="1" rowspan="3"onclick="selectCell(this, event)"></td>

         <th colspan="2" class="c">PART NO.</th>
         <td colspan="3" onclick="selectCell(this, event)">
            </th>
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <th colspan="2" class="c">OPERATOR NAME</th>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>

         <th colspan="2" class="c">MODEL</th>
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <th colspan="2" class="c" onclick="selectCell(this, event)">PROD. ENGINEER</th>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>

         <th colspan="2" class="c">COLOUR</th>
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <td colspan="3" onclick="selectCell(this, event)"></td>
         <th colspan="2" class="c">QA. ENGINEER</th>
         <!-- <td colspan="1" onclick="selectCell(this, event)"> -->
            </th>
            <!-- <th></th> -->
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th class="c" colspan="2">CHECK POINT AS PER PQC STD.</th>
         <th colspan="2" class="c">SPECIFICATION</th>
         <th colspan="1">7-9</th>
         <th colspan="1">9-11</th>
         <th colspan="1">11-1</th>
         <th colspan="1">1-3</th>
         <th colspan="1">3-5</th>
         <th colspan="1">5-7</th>
         <th colspan="1">7-9</th>
         <th colspan="1">9-11</th>
         <th colspan="1">11-1</th>
         <th colspan="1">1-3</th>
         <th colspan="1">3-5</th>
         <th colspan="1">5-7</th>
      </tr>
      <tr>
         <th class="c" colspan="1">1.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>

      </tr>
      <tr>
         <th class="c" colspan="1">2.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th class="c" colspan="1">3.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <!-- <tr>
         <th class="c" colspan="1">4.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr> -->
      <tr>
         <th class="c" colspan="1">4.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th class="c" colspan="1">5.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>

      <tr>
         <th class="c" colspan="1">6.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th class="c" colspan="1">7.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th class="c" colspan="1">8.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th class="c" colspan="1">9.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th class="c" colspan="1">10.</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">Component Weight(gm)</th>
         <th colspan="2">AS PER WEIGHT LIST</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Flashes</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Flow mark</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Scratch/Weld line/Flow line</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Crack/Broken</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Short molding</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Short molding</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No color Mismatch(appearance)</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Rubbing mark/Bubble</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Black/white spot</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">No Spray mark</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">Fitment with matching part</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">Assembly</th>
         <th colspan="2">VISUAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>
      <tr>
         <th colspan="2" class="c">Packing as per std.</th>
         <th colspan="2">VISUAL/PHYSICAL</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>

      <tr>
         <th colspan="2" class="c">M/c Counter Reading</th>
         <th colspan="2">BY M/C COUNTER</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>

      <tr>
         <th colspan="2" class="c">Rejection</th>
         <th colspan="2">PHYSICAL COUNTER</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
      </tr>



      <tr>
         <th colspan="3" class="c">Process Parameter according tom SPP</th>
         <th colspan="1">Visual/Physical</th>
         <th colspan="2">Content</th>
         <th colspan="2">Standard</th>
         <th colspan="2">11AM</th>
         <th colspan="2">4PM</th>
         <th colspan="2">11PM</th>
         <th colspan="2">4AM</th>
      </tr>


      <tr>
         <th colspan="2" class="c" >Signature</th>
         <th colspan="1">QA Engineer</th>
         <th colspan="1">Process Engineer</th>
         <th colspan="2">Cycle Time</th>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>

      </tr>

      <tr>
         <th colspan="2" class="c">Shift-A</th>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <td colspan="1" onclick="selectCell(this, event)"></td>
         <th colspan="2">Cooloing Time</th>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>

      </tr>

      <th colspan="2" class="c">Shift-B</th>
      <td colspan="1" onclick="selectCell(this, event)"></td>
      <td colspan="1" onclick="selectCell(this, event)"></td>
      <th colspan="2">Short size</th>
      <td colspan="2" onclick="selectCell(this, event)"></td>
      <td colspan="2" onclick="selectCell(this, event)"></td>
      <td colspan="2" onclick="selectCell(this, event)"></td>
      <td colspan="2" onclick="selectCell(this, event)"></td>
      <td colspan="2" onclick="selectCell(this, event)"></td>
      </tr>


      <tr>
         <th colspan="2" class="c">Approved by</th>
         <th colspan="2">Checked by</th>
         <th colspan="2">Nozzel Temp.</th>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>

      </tr>

      <tr>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <th colspan="2">Injection Time</th>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
         <td colspan="2" onclick="selectCell(this, event)"></td>
      </tr>

      <tr>
         <th colspan="16" class="c">As per customer specific requirement above mention dimension reading are considered for SPC</th>
      </tr>



      <tr>
         <th colspan="16" class="c">Format History</th>
      </tr>
      <tr>

         <th colspan="1" class="c">S.N.</th>
         <th colspan="2">Before</th>
         <th colspan="1">Change details</th>
         <th colspan="10">Reason of change</th>
         <th colspan="3">Effective date</th>
      </tr>
     

   </tbody>
</table>



   <script>
      let selectedOption = '';
      let activeCell = null;
      let currentSheet = 1;
      const optionsMenu = document.getElementById('optionsMenu');
      const specialMenu = document.getElementById('specialMenu');

      function setSelectedOption(option) {
          selectedOption = option;
          if (activeCell) fillCell(activeCell);
      }

      function selectCell(cell, event) {
          if (activeCell) activeCell.classList.remove('selected');
          activeCell = cell;
          cell.classList.add('selected');

          const rect = cell.getBoundingClientRect();
          optionsMenu.style.left = `${rect.left + rect.width / 2 - optionsMenu.offsetWidth / 2}px`; // Center the menu horizontally

        //  optionsMenu.style.left = `${rect.left  - optionsMenu.offsetWidth}px`;
         optionsMenu.style.top = `${rect.bottom + window.scrollY + 5}px`; // Position below the selected cell with a 5px gap
         optionsMenu.style.display = 'block';
          
      }

      function fillCell(cell) {
          cell.innerHTML = selectedOption;
          cell.classList.remove('selected');
          activeCell = null;
          optionsMenu.style.display = 'none';
          saveTableData();
      }

      function enterText() {
          if (!activeCell) {
              alert('Please select a cell first!');
              return;
          }

          let textField = document.createElement('input');
          textField.type = 'text';
          textField.value = activeCell.innerHTML;
          textField.style.width = `${activeCell.offsetWidth - 2}px`; // Adjust width to match cell size
          textField.style.height = `${activeCell.offsetHeight - 2}px`; // Adjust height to match cell size
          textField.style.fontSize = '12px';
          textField.style.textAlign = 'center';
          textField.style.boxSizing = 'border-box'; // Make sure padding and borders are included in size

          textField.onblur = function () {
              activeCell.innerHTML = textField.value;
              activeCell.classList.remove('selected');
              activeCell = null;
              optionsMenu.style.display = 'none';
              saveTableData();
          };

          activeCell.innerHTML = ''; // Clear cell contents and append the input field
          activeCell.appendChild(textField);
          textField.focus();
      }

      function specialText(symbol) {
          if (!activeCell) {
              alert('Please select a cell first!');
              return;
          }
          activeCell.innerHTML += symbol; // Append symbol to existing content
          activeCell.classList.remove('selected');
          activeCell = null;
          specialMenu.style.display = 'none';
          saveTableData();
      }

      function toggleSpecialMenu() {
          const specialButton = optionsMenu.querySelector('button[onclick="toggleSpecialMenu()"]');
          const rect = specialButton.getBoundingClientRect();


         // specialMenu.style.left = `${rect.left}px`; // Align with the button
          
         specialMenu.style.left = `${rect.left + window.scrollX}px`; // Align with the button
         specialMenu.style.top = `${rect.bottom + window.scrollY + 5}px`; // Position directly below the button
         specialMenu.style.display = specialMenu.style.display === 'block' ? 'none' : 'block';
      }

      function saveTableData() {
          const tableData = [];
          const rows = document.querySelectorAll('#dataTable tbody tr');
          rows.forEach(row => {
              const rowData = Array.from(row.querySelectorAll('td')).map(cell => cell.innerHTML);
              tableData.push(rowData);
          });
          // Store data specifically for the current sheet
          localStorage.setItem(`tableData_sheet${currentSheet}`, JSON.stringify(tableData));
      }

      function loadTableData() {
          const savedData = localStorage.getItem(`tableData_sheet${currentSheet}`);
          const rows = document.querySelectorAll('#dataTable tbody tr');

          // Clear existing table data
          rows.forEach(row => {
              Array.from(row.querySelectorAll('td')).forEach(cell => {
                  cell.innerHTML = '';
              });
          });

          if (savedData) {
              const tableData = JSON.parse(savedData);
              tableData.forEach((rowData, rowIndex) => {
                  if (rows[rowIndex]) {
                      Array.from(rows[rowIndex].querySelectorAll('td')).forEach((cell, cellIndex) => {
                          cell.innerHTML = rowData[cellIndex] || '';
                      });
                  }
              });
          }
      }

      function switchSheet(sheetNumber) {
          currentSheet = sheetNumber;
          document.querySelectorAll('.sheet-buttons button').forEach(button => button.classList.remove('active'));
          document.getElementById(`sheet${sheetNumber}`).classList.add('active');
          loadTableData();
      }

      // Load initial sheet data
      document.addEventListener('DOMContentLoaded', () => {
          switchSheet(1);
      });




      function printTable() {
         window.print();
      }

      // function backToIndex() {
      //    window.history.back();
      // }

        function backToIndex() {
            window.location.href = '../main_page/main.html';
        }


      function clearTableData() {
         if(confirm("Are you sure you want to reset?")) {
            localStorage.removeItem(`tableData_sheet${currentSheet}`);
            loadTableData(currentSheet);
         }
      }
  </script>
</body>

</html>
